# Microsoft is threatening national security

On July 27, U.S. Senator Ron Wyden wrote an official letter 
to the Attorney General of the U.S. Department of Justice, 
the head of the Federal Trade Commission, 
and to the Director of the Cybersecurity and Infrastructure Security Agency, or CISA.
In other words, the letter calls out the three most capable people in the world
in the regulation of private American digital companies.
It opens with the following sentence, and I quote, translating:
"I am writing to ask your agencies to intervene to hold Microsoft accountable 
for its negligent cybersecurity practices,
which enabled the success of a Chinese espionage campaign 
against the U.S. government".  
https://www.wyden.senate.gov/imo/media/doc/wyden_letter_to_cisa_doj_ftc_re_2023_microsoft_breach.pdf

In this case, Wyden is referring to suspicious anomalies detected in June 2023
by CISA and the Federal Bureau of Investigation, better known as the FBI.  
https://www.cisa.gov/news-events/alerts/2023/07/12/cisa-and-fbi-release-cybersecurity-advisory-enhanced-monitoring-detect-apt-activity-targeting

It was only once these anomalies had been detected 
that Microsoft launched an investigation into a cyber attack in progress,  
https://msrc.microsoft.com/blog/2023/07/microsoft-mitigates-china-based-threat-actor-storm-0558-targeting-of-customer-email/  
which forced them to recognize critical flaws in the operation of its Cloud services,
including email services such as Outlook and Microsoft Exchange:
many critical U.S. government accounts, 
used for all kinds of highly sensitive and classified exchanges,
had been hacked, probably by a Chinese group called Storm-0558.  
https://msrc.microsoft.com/blog/2023/09/results-of-major-technical-investigations-for-storm-0558-key-acquisition/

Now, as we shall see, 
this is far from the first time that major vulnerabilities have been found
in critical Microsoft systems,
which are already massively purchased and used by many major organizations,
such as the government of the world's most powerful economy,
but also, most probably, the company in which you, dear viewers, work ;
and other accusations of irresponsible negligence have since been made,
to which I shall return.  
https://www.linkedin.com/pulse/microsoftthe-truth-even-worse-than-you-think-amit-yoran

But in the current context of growing geopolitical tension around the world,
with coups d'Ã©tats in Africa, war in Ukraine, provocations from China,
and the trivialization of hatred in the world's most solid democracies,  
https://www.v-dem.net/publications/democracy-reports/  
in a context where cybercrime is proliferating and becoming increasingly profitable,
with exponential growth in the costs it generates  
https://www.weforum.org/agenda/2023/06/cyber-insurance-security-cybercrime/  
and the involvement of a growing diversity of malicious actors,  
https://thisishowtheytellmetheworldends.com/  
and, above all, in a context where every organization in the world,
from governments and banks to power grids and hospitals,
have become extremely dependent on the smooth running of the cloud,  
https://www.bfmtv.com/paris/ile-de-france-les-hopitaux-de-l-ap-hp-touches-par-une-panne-geante_AN-202308300548.html  
i.e. IT services managed remotely by companies like Microsoft,
the discovery of the exploitation of the Microsoft Cloud by Chinese hackers
is a serious source of concern, even beyond the case of the US government emails.

There's an old saying that "nobody ever got fired for buying Microsoft".
The history of Microsoft vulnerabilities should arguably challenge this saying.  
https://www.lesechos.fr/tech-medias/hightech/letat-choisit-microsoft-pour-les-donnees-de-sante-et-cree-la-polemique-1208376  
Knowing everything we know about this company's neglect of cybersecurity,
and knowing to what extent the economic security of companies,
and therefore the financial stability of employees, depends on cybersecurity,
purchasing Microsoft products without assessing the associated risks should be inadmissible.
In fact, today, there is a far from negligible probability that,
accepting a Microsoft information service for your company is allowing cybercriminal actors, 
such as competitors or foreign governments,
access to your company's sensitive information,
or even to control of your cloud operations.
Given the known vulnerabilities of Microsoft Cloud, 
it would be irresponsible not to question the digital habits of our companies.

## Half a century of negligence

Historically, one of the first big shocks to the American government 
was the terrorist attack of September 18, 2001.
Yes, I did say September 18.
One week after the one you know about,
which attacked the World Trade Center towers in New York,
a hybrid computer worm caused unprecedented catastrophes.
The worm was called Nimda, which is letter-for-letter inverse of Admin.
It exploited vulnerabilities in Microsoft systems,
to replicate and propagate itself from machine to machine,
causing all kinds of information overload in information systems,
which prevented machines from performing the tasks 
for which they were programmed.  
https://en.wikipedia.org/wiki/Nimda

But while it's true that Nimda was spectacular and very costly, 
it was not the greatest fear of the American Defense Department,
which was far more concerned about attacks capable of taking 
control of critical information systems without being detectable.
The most dangerous enemies are still the ones you can't see;
and for many months, the infiltration of Microsoft by Chinese hackers was of this kind.
In any case, it is in a post-9/11 climate of great concern for national security risks
that Microsoft came under heavy pressure from the American authorities.

This is likely what prompted a memo from Bill Gates, 
Microsoft's billionaire founder,
which intended to mark the day when cybersecurity became the company's "highest priority".
"Within 10 years, it will be an integral and indispensable part of almost everything we do," he wrote.
"Microsoft and the computer industry will only succeed in that world 
if [Chief Information Officers], consumers and everyone else sees 
that Microsoft has created a platform for Trustworthy Computing."  
https://www.wired.com/2002/01/bill-gates-trustworthy-computing/

If the first part of this quote is a very accurate prediction,
the second is in fact highly questionable,
not least because citizens and governments have consistently been failing
to pay sufficient attention to the notion of digital trust.
As long as monumental scandals of cybersecurity negligence are ignored,
we seem doomed to be trusting digital tools we shouldn't be trusting,
like ultra-connected phones with always-functioning microphones,
applications controlled by authoritarian governments 
already clearly engaged in cyberwarfare like TikTok,
or computing machines with an extremely poor cybersecurity track record,
in which we nevertheless store so much sensitive data
and with which we access systems we'd like to be the only ones to control,
like our bank accounts.

In fact, I'd say if he really wanted to optimize his philanthropy,
Bill Gates should probably take a much greater interest in cybersecurity,
especially the one that the company he founded seems to be handling so carelessly,
thereby potentially exposing billions of users,
millions of businesses and thousands of government and international organizations.

Now, to be fair to Microsoft, since 2001, they've definitely improved.
For one thing, in October 2003, they introduced Patch Tuesday.
On the second Tuesday of every month, 
critical security updates were offered,
and were to be carried out by customers to protect their systems;
though this lead to "Wednesday exploits",
which attempt to hack Microsoft systems that have not been updated yet.
This is the perfect opportunity for me to invite you to update your software 
as soon as an update is available,
especially those that communicate extensively with the Internet, 
like Firefox, Chrome or Edge web browsers.
That said, now that computing is moving so fast,
monthly updates seem inappropriate according to many experts,
especially developers of Open Source systems like Linux,
who prefer to release a security update as soon as it becomes available,
instead of leaving a delay during which the vulnerability known to the developer can be leaked,
and become known to cyber attackers.  
https://en.wikipedia.org/wiki/Patch_Tuesday

In any case, despite Bill Gates' memo,
and despite an improvement in the attention given to security by Microsoft,
for two decades now,
critical flaws in Microsoft systems have been discovered again and again,
and, more importantly, they have been exploited by cybercriminals.
Among the most spectacular cases was Stuxnet in 2010,
an NSA worm that exploited vulnerabilities in Windows 
to sabotage Iran's nuclear program, 
causing uranium enrichment machines to self-destruct 
in a way that was difficult to detect.  
https://tournesol.app/entities/yt:U_7CGl6VWaQ

Another serious case is the 2009 Operation Aurora, which enabled Chinese hackers to
to infiltrate the systems of numerous American giants, including Google, 
by exploiting a flaw in Microsoft Internet Explorer ;
a flaw that Microsoft knew about 3 months before the attack,
but had not taken the time to correct.  
https://en.wikipedia.org/wiki/Operation_Aurora

Then in 2017, there was WannaCry a computer worm attributed to North Korea,
which exploits vulnerabilities in older Microsoft systems, 
encrypts data on the target machine
and demands a Bitcoin ransom to decrypt this data -
this is known as a ransomware.  
https://tournesol.app/entities/yt:nIRDzPnJAro

And then, more recently, in 2020, Russian hackers hacked SolarWinds,
exploiting vulnerabilities in Microsoft 
to penetrate several parts of the U.S. government
and to leak sensitive data.  
https://www.microsoft.com/en-us/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-day-exploit/  
https://www.politico.eu/article/solarwinds-largest-cyberattack-ever-microsoft-president-brad-smith/

In his letter, Senator Ron Wyden points out that 
Microsoft had known about the vulnerabilities in its authentication system since 2017,
three years before the Russian hackers' attack took place, 
and was detected by U.S. agencies.
But, once again, Microsoft didn't fix the flaw, 
nor did it warn its customers who were using its flawed technologies.
As Wyden writes: 

"Microsoft never acknowledged responsibility for the SolarWinds hack ... 
Instead, Microsoft used the incident as an opportunity 
to promote its Azure AD product ... 
Microsoft customers heard the message 
[that] it was too difficult
to secure their own server keys, 
[and that it was safer to] let Microsoft do it for them ... 
[Three years later], revenues from Microsoft's professional cloud security services 
have grown to more than $20 billion a year."  
https://www.wyden.senate.gov/imo/media/doc/wyden_letter_to_cisa_doj_ftc_re_2023_microsoft_breach.pdf

Which makes the critical flaws in Microsoft's mail service all the more inexcusable,
especially given that their recent communications have focused on ChatGPT,
a solution that was itself rapidly hacked.  
https://www.securityweek.com/chatgpt-data-breach-confirmed-as-security-firm-warns-of-vulnerable-component-exploitation/

And yet, we're still a long way from scratching the surface of the immense iceberg
of the major cybersecurity vulnerabilities present in Microsoft products.
I'll just mention a couple of particularly revealing ones.

On June 4, 2021, the 32nd anniversary of the Tiananmen massacre,
and while pro-democracy activists were being repressed in Hong Kong,
searches for "Tank Man" on Microsoft Bing censored
the image and video of the courageous man who opposed the tank parade, 
who had since become the symbol of the months of pacifist, pro-democracy demonstrations 
which the Chinese authorities punished in a horrific bloodbath.  
https://tournesol.app/entities/yt:Je7dhUaO8Rg  
And even if, rather than a hack, 
one might conjecture Microsoft's complicity with a bloodthirsty dictatorship, 
which is well documented in the case of the use of Microsoft Bing in the Chinese lan guage,  
https://archive.nytimes.com/kristof.blogs.nytimes.com/2009/11/20/boycott-microsoft-bing/  
Microsoft preferred to speak officially of "human error".  
https://www.theguardian.com/technology/2021/jun/04/microsoft-bing-tiananmen-tank-man-results  
In both cases, Microsoft should be accountable,
at least to pro-democracy activists in Hong Kong.  
https://en.wikipedia.org/wiki/Criticism_of_Microsoft#Censorship_in_China  
https://www.reuters.com/technology/microsoft-bing-raises-concerns-over-lack-image-results-tiananmen-tank-man-2021-06-04/

Finally, more recently, in March 2023, 
cybersecurity firm Tenable identified a critical vulnerability 
in Microsoft's Cloud service which, according to their CEO Amit Yoran,
gave them access to a bank's authentication secrets.
They alerted Microsoft, but complained of the company's inattention to this critical flaw.
120 days after reporting the problem the bank was still vulnerable.
As Yoran writes: "This is grotesquely irresponsible, if not blatantly negligent".  
https://www.linkedin.com/pulse/microsoftthe-truth-even-worse-than-you-think-amit-yoran  
https://www.tenable.com/security/research/tra-2023-25

## The flaws revealed this summer

So, this summer, Microsoft did it again,
with a flaw affecting its Cloud service,
which Microsoft claimed to be particularly secure
to attract many new customers who were overwhelmed by cybersecurity issues.
Customers' trust was once again betrayed -
but given the media's inattention to this major event,
I fear that customers will fail to reassess the appropriate trust 
they should have in Microsoft's products.

So what happened?
To understand, let me first present the authentication system
that Microsoft set up for its online services,
and how it was supposed to guarantee the security of customer information
and their access to Microsoft Cloud applications.
Finally, we'll take a look at the broad outlines, 
with a few simplifications so you don't get lost.

Basically, to use Microsoft Cloud services,
you'll first have to go through an authentication procedure.
To do this, you need to send authentication information to a Microsoft server, 
typically multiple authentications like a password and confirmation by phone.
If all goes well,
the Microsoft authentication server will send you an authentication token,
which the server will certify by including a cryptographic signature,
produced using a *signature key*.
Put differently, the cryptographic signature is a verifiable certificate 
that can only be generated by a machine that possesses the signing key.
Remember, the token is certified by being signed by the signature key, 
which is supposed to be ultra-secret
and to be only stored on Microsoft servers, to which no human should have access.
This will be important in understanding the Chinese group's hack.

Secondly, to use a Microsoft Cloud service, 
such as Outlook, Office, SharePoint, OneDrive or Teams,
your machine will send the signed token to a Microsoft Cloud application,
which will verify the token's signature.
If the signature is correct, that is, it matches the signing key it claims to be produced with,
then the Cloud application will give you access to its services.
Note that some applications not developed by Microsoft are also designed 
with authentication via Microsoft's signed tokens;
typically those with "Login via Microsoft" functionality.
In fact, the whole point of the signed token is that applications, Microsoft or not,
don't have to develop their own authentication solutions;
they just have to check that the token has been signed by a Microsoft signature key.

But then, as you can imagine, 
the security of the signing key is absolutely critical.
As we've seen, many Microsoft applications simply check 
the validity of the signature of a token submitted to them 
to give access to their services, as specified by the token.
And that's why this signature key follows additional security procedures
in the Microsoft system.
For a start, this key eventually expires,
This prevents a stolen key from guaranteeing indefinite access.
What's more, it is supposed to exist only in the production environment,
which is detached from the network of Microsoft employees' machines.
In particular, not even Microsoft employees have access to it.
This is sometimes referred to as sandboxing: access to the production environment is restricted,
and in this case, it is forbidden to employees.

But like all sandboxing schemes, 
there are still communication channels between the different sandboxes.
In our case, the production network still sends information to the employee network.
This information must then be monitored as closely as possible.
One kind of information that flows from the production network to the employee network 
is the transfer of crash information.
If a machine on the production network has a crash,
then employees are given access to information about the crash,
to enable them to understand and repair the crash.

OK. We've got just about everything we need to understand 
the cyber attack on the Microsoft Cloud ---
or at least what Microsoft was willing to reveal, 
under pressure from Senator Ron Wyden.  
https://msrc.microsoft.com/blog/2023/09/results-of-major-technical-investigations-for-storm-0558-key-acquisition/

In April 2021, there was a crash in the production network.
A recording was then made of the state of the system at the time of the crash.
Microsoft refers to this as a crash dump.
This crash dump was transferred to the employee network.
Except, as you might expect, apparently due to a bug,
the crash dump contained a Microsoft key;
and Microsoft's sensitive information detection tools
failed to detect the presence of this ultra-sensitive key in the crash dump.
The key then ended up on the employee network, which is less secure, 
if only because Microsoft employees have access to it.

According to Microsoft, the account of a Microsoft engineer got hacked,
apparently by Chinese attackers.
This gave the attackers access to the crash dump, and therefore to the private key.
This enabled them to create authentication tokens,
and to sign them with a Microsoft signature key.
These signed tokens then gave them illicit access to Microsoft Cloud services, 
such as the emails of a customer of the service.

Now, in principle, these attackers shouldn't have been able to get very far,
because the key they stole was due to expire in April 2021,
and a priori they accessed it after April 2021.
But strangely enough, Microsoft's applications had not encoded this expiration,
and allowed the attackers to continue exploiting the signing key until July 2023.
And what we know is that they used it to access Outlook emails from US government agencies.

NB: Yet another flaw in Microsoft's system was the possibility of accessing
an organization's Cloud services using only the consumer access of a member of the organization.
A signature key for Microsoft consumers, known as a consumer key,
which a priori only allows to enable access to the consumer's personal Microsoft services,
was enough to access these users' professional accounts.

Now, allowing a foreign power to access the confidential exchanges of a country's leaders
is already extremely serious.
But it's doubtful that the hack stopped there.
In fact, the same signed tokens used to access these e-mails could also be used to access 
many other Microsoft services;
but it's hard to be sure, 
everything depends on the details of how the tokens signed by the stolen key are accepted 
by the various services.
In any case, it is unlikely that these attackers did not 
tried to infiltrate more targets,
and in particular to establish a persistent presence in many customers' Cloud services.
The cybersecurity firm Wiz thus considers it possible that 
the attackers modified the authentication mechanisms of the applications they hacked,
to enable backdoors through which they could log on 
at any time in the future.  
https://www.wiz.io/blog/storm-0558-compromised-microsoft-key-enables-authentication-of-countless-micr

For more detailed information about the attack,
and to better understand both what we know,
but also what's still very unclear and still a cause for concern,
I recommend you read the latest Wiz blog post on the subject:  
https://www.wiz.io/blog/key-takeaways-from-microsofts-latest-storm-0558-report

To recap, Microsoft leaked an ultra-sensitive key in a crash dump;
then failed to detect the presence of this key in the crash dump,
then had an engineer employee account hacked,
then validated tokens signed with an expired signing key;
and again, I've only listed a few of the major flaws in Microsoft's system.
This seems arguably sufficient to justify the use of the harsh phrase 
"negligent cybersecurity practices" used by Senator Wyden, 
to describe the appropriate level of trust that Microsoft's services deserve.

## What to do?

Microsoft seems a long way from the security standards that 
its dominant role in global information processing should demand.
Back in 2001, this was already a big problem.
But in 2023, as Senator Ron Wyden well understands,
Microsoft's inattention to cybersecurity is a threat to national security.
After all, beyond the many failures we've talked about today,
last summer's cyber attack above all exposes the ubiquity of vulnerabilities
which Microsoft's critical services are guilty of having allowed to linger,
and the civilizational danger of giving Microsoft control over the servers responsible for 
banking transactions, controlling the power grid,
or managing hospitals and insurance companies.

OK. But what can we do? What can *you* do?
The first thing to do, I think, is to stop turning a blind eye,
or divert our attention from these civilizational risks,
by giving in to the temptation to dismiss those who study them as alarmists.
Please take the time to really assess the cybersecurity of today's critical information systems.
Even without going into the technical details
it is possible to assess the extent of the risks,
simply by asking what measures are in place to mitigate them,
whether by Microsoft, your employer or our governments.
And to find out more, I cannot sufficiently recommend
the extremely well-documented book "This is how they tell me the world ends"
by New York Times journalist Nicole Perlroth,
who has specialized in cybersecurity issues for over a decade.  
https://thisishowtheytellmetheworldends.com/

This book has changed my understanding of the fragility of our civilization;
and I have no doubt that, if you read it,
you too will see the world very differently.
A world that very much resembles a house of cards, 
that many obscure groups want to destroy
and which democracies are far too slow to fortify.

Once informed, I'm sure you'll question in particular 
the inattention of private companies to cybersecurity,
and their massive investment in the development of new technologies
which are far less secure still.  
https://tournesol.app/entities/yt:E9c2y0eUBMs  
In particular, rather than blindly buying services from Microsoft,
because that's what everyone does and "no one's ever been fired" for it,
I hope you'll consider alternative solutions,
especially those with a much less compromising cybersecurity track record,
as French administrations are starting to do.  
https://siecledigital.fr/2021/09/24/etat-francais-micorost-365/  
https://www.lemondeinformatique.fr/actualites/lire-l-education-nationale-exclut-les-offres-gratuites-office365-et-workspace-dans-les-ecoles-88617.html

That said, a more effective solution for drastically increasing the cybersecurity of your company,
and our civilization in general, is *digital sobriety*.
In particular, the fewer applications you have on your computers, tablets and phones,
the fewer vectors there will be through which cyber-attackers can compromise your information.
Do you really need to install on your business phone 
the application that stylizes your portraits with a generative algorithm?  
https://www.heidi.news/cyber/jamais-chatgpt-n-aurait-du-etre-deploye-pour-le-grand-public  
In particular, the simplest measure you can take 
to drastically increase your cybersecurity,
is to uninstall all the obscure and non-essential plugins 
you're using in your web browsers
and even more so in your development environments such as Microsoft VS Code.  
https://tournesol.app/entities/yt:ghVWFZ5esnU  
And if you can do one task without using ChatGPT
or any other hastily developed solution,
I can only encourage you and your companies to do without,
and thus reduce what cybersecurity researchers call the *attack surface*.

But above all, I urge you to demand much more 
from your company's information service providers,
not only when talking directly to them,
but also, and above all, by asking politicians to impose mandatory external cybersecurity audits,
or even, in the case of massively used technologies that are likely to be illegal,
to adopt a presumption of non-compliance.  
https://cnnumerique.fr/paroles-de/les-grands-modeles-de-langage-quels-risques-echange-avec-le-nguyen-hoang

Finally, I urge you to make cybersecurity a topic of discussion,
especially within your company.
What would happen if your company came under attack?
Could it be easily hacked by the first cybercriminal?
Is it enough to compromise one employee to compromise everything?
How can you reduce the risk of one of your many colleagues being compromised?
What would be the impact of a theft of your customers' or suppliers' data?
What about a long-term paralysis of your information system?

If the answers to this question are unclear to you,
then you probably need to give it some urgent thought.
I encourage you to organize meetings, seminars or training on the subject.
And if your company can afford it, 
you can hire the services of my company, Calicarpa,
which not only develops safety products, 
but also offers training and consulting in cybersecurity to its corporate customers,
if only to better assess the extent of the risks to which your company is exposed.  
https://calicarpa.com/


Hey, so this is the Le of the future, who has just discovered yet another Microsoft disaster.
Cybersecurity firm Wiz has revealed a massive data leak via Microsoft GitHub,
the platform that many private companies use to store their code in the clear.
Apparently, a mistake was made by employees of Microsoft's AI research division, 
who wanted to share AI models on GitHub ;
but instead of sharing only these models
they made available all the Cloud data associated with the account they were using,
which included a system backup of two Microsoft employees,
which itself contained private keys, secrets, passwords 
and 30,000 Microsoft Teams messages.
Ironically, the GitHub account explained how to share data 
via the Microsoft cloud. 
Microsoft's hacking never gets old...  
https://www.wiz.io/blog/38-terabytes-of-private-data-accidentally-exposed-by-microsoft-ai-researchers


